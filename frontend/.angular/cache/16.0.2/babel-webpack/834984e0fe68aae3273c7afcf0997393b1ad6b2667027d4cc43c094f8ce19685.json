{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { Order } from 'src/app/shared/models/Order';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/cart.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"src/app/services/user.service\";\nimport * as i4 from \"ngx-toastr\";\nimport * as i5 from \"src/app/services/order.service\";\nimport * as i6 from \"@angular/router\";\nclass CheckoutPageComponent {\n  constructor(cartService, formBuilder, userService, toastrService, orderService, router) {\n    this.formBuilder = formBuilder;\n    this.userService = userService;\n    this.toastrService = toastrService;\n    this.orderService = orderService;\n    this.router = router;\n    this.order = new Order();\n    const cart = cartService.getCart();\n    this.order.items = cart.items;\n    this.order.totalPrice = cart.totalPrice;\n  }\n  ngOnInit() {\n    let {\n      name,\n      address\n    } = this.userService.currentUser;\n    this.checkoutForm = this.formBuilder.group({\n      name: [name, Validators.required],\n      address: [address, Validators.required]\n    });\n  }\n  get fc() {\n    return this.checkoutForm.controls;\n  }\n  createOrder() {\n    if (this.checkoutForm.invalid) {\n      this.toastrService.warning('Please fill the inputs', 'Invalid Inputs');\n      return;\n    }\n    if (!this.order.addressLatLng) {\n      this.toastrService.warning('Please select your location on the map', 'Location');\n      return;\n    }\n    this.order.name = this.fc.name.value;\n    this.order.address = this.fc.address.value;\n    this.orderService.create(this.order).subscribe({\n      next: () => {\n        this.router.navigateByUrl('/payment');\n      },\n      error: errorResponse => {\n        this.toastrService.error(errorResponse.error, 'Cart');\n      }\n    });\n  }\n}\nCheckoutPageComponent.ɵfac = function CheckoutPageComponent_Factory(t) {\n  return new (t || CheckoutPageComponent)(i0.ɵɵdirectiveInject(i1.CartService), i0.ɵɵdirectiveInject(i2.FormBuilder), i0.ɵɵdirectiveInject(i3.UserService), i0.ɵɵdirectiveInject(i4.ToastrService), i0.ɵɵdirectiveInject(i5.OrderService), i0.ɵɵdirectiveInject(i6.Router));\n};\nCheckoutPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CheckoutPageComponent,\n  selectors: [[\"app-checkout-page\"]],\n  decls: 0,\n  vars: 0,\n  template: function CheckoutPageComponent_Template(rf, ctx) {},\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});\nexport { CheckoutPageComponent };","map":{"version":3,"names":["Validators","Order","CheckoutPageComponent","constructor","cartService","formBuilder","userService","toastrService","orderService","router","order","cart","getCart","items","totalPrice","ngOnInit","name","address","currentUser","checkoutForm","group","required","fc","controls","createOrder","invalid","warning","addressLatLng","value","create","subscribe","next","navigateByUrl","error","errorResponse","i0","ɵɵdirectiveInject","i1","CartService","i2","FormBuilder","i3","UserService","i4","ToastrService","i5","OrderService","i6","Router","selectors","decls","vars","template","CheckoutPageComponent_Template","rf","ctx","styles"],"sources":["G:\\APP\\frontend\\src\\app\\components\\pages\\checkout-page\\checkout-page.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { ToastrService } from 'ngx-toastr';\nimport { CartService } from 'src/app/services/cart.service';\nimport { OrderService } from 'src/app/services/order.service';\nimport { UserService } from 'src/app/services/user.service';\nimport { Order } from 'src/app/shared/models/Order';\n\n@Component({\n  selector: 'app-checkout-page',\n  templateUrl: './checkout-page.component.html',\n  styleUrls: ['./checkout-page.component.css']\n})\nexport class CheckoutPageComponent implements OnInit {\n  order:Order = new Order();\n  checkoutForm!: FormGroup;\n  constructor(cartService:CartService,\n              private formBuilder: FormBuilder,\n              private userService: UserService,\n              private toastrService: ToastrService,\n              private orderService: OrderService,\n              private router: Router) {\n                const cart = cartService.getCart();\n                this.order.items = cart.items;\n                this.order.totalPrice = cart.totalPrice;\n              }\n\n  ngOnInit(): void {\n    let {name, address} = this.userService.currentUser;\n    this.checkoutForm = this.formBuilder.group({\n      name:[name, Validators.required],\n      address:[address, Validators.required]\n    });\n  }\n\n  get fc(){\n    return this.checkoutForm.controls;\n  }\n\n  createOrder(){\n    if(this.checkoutForm.invalid){\n      this.toastrService.warning('Please fill the inputs', 'Invalid Inputs');\n      return;\n    }\n\n    if(!this.order.addressLatLng){\n      this.toastrService.warning('Please select your location on the map', 'Location');\n      return;\n    }\n\n    this.order.name = this.fc.name.value;\n    this.order.address = this.fc.address.value;\n\n    this.orderService.create(this.order).subscribe({\n      next:() => {\n        this.router.navigateByUrl('/payment');\n      },\n      error:(errorResponse) => {\n        this.toastrService.error(errorResponse.error, 'Cart');\n      }\n    })\n  }\n}\n"],"mappings":"AACA,SAAiCA,UAAU,QAAQ,gBAAgB;AAMnE,SAASC,KAAK,QAAQ,6BAA6B;;;;;;;;AAEnD,MAKaC,qBAAqB;EAGhCC,YAAYC,WAAuB,EACfC,WAAwB,EACxBC,WAAwB,EACxBC,aAA4B,EAC5BC,YAA0B,EAC1BC,MAAc;IAJd,KAAAJ,WAAW,GAAXA,WAAW;IACX,KAAAC,WAAW,GAAXA,WAAW;IACX,KAAAC,aAAa,GAAbA,aAAa;IACb,KAAAC,YAAY,GAAZA,YAAY;IACZ,KAAAC,MAAM,GAANA,MAAM;IAP1B,KAAAC,KAAK,GAAS,IAAIT,KAAK,EAAE;IAQX,MAAMU,IAAI,GAAGP,WAAW,CAACQ,OAAO,EAAE;IAClC,IAAI,CAACF,KAAK,CAACG,KAAK,GAAGF,IAAI,CAACE,KAAK;IAC7B,IAAI,CAACH,KAAK,CAACI,UAAU,GAAGH,IAAI,CAACG,UAAU;EACzC;EAEZC,QAAQA,CAAA;IACN,IAAI;MAACC,IAAI;MAAEC;IAAO,CAAC,GAAG,IAAI,CAACX,WAAW,CAACY,WAAW;IAClD,IAAI,CAACC,YAAY,GAAG,IAAI,CAACd,WAAW,CAACe,KAAK,CAAC;MACzCJ,IAAI,EAAC,CAACA,IAAI,EAAEhB,UAAU,CAACqB,QAAQ,CAAC;MAChCJ,OAAO,EAAC,CAACA,OAAO,EAAEjB,UAAU,CAACqB,QAAQ;KACtC,CAAC;EACJ;EAEA,IAAIC,EAAEA,CAAA;IACJ,OAAO,IAAI,CAACH,YAAY,CAACI,QAAQ;EACnC;EAEAC,WAAWA,CAAA;IACT,IAAG,IAAI,CAACL,YAAY,CAACM,OAAO,EAAC;MAC3B,IAAI,CAAClB,aAAa,CAACmB,OAAO,CAAC,wBAAwB,EAAE,gBAAgB,CAAC;MACtE;;IAGF,IAAG,CAAC,IAAI,CAAChB,KAAK,CAACiB,aAAa,EAAC;MAC3B,IAAI,CAACpB,aAAa,CAACmB,OAAO,CAAC,wCAAwC,EAAE,UAAU,CAAC;MAChF;;IAGF,IAAI,CAAChB,KAAK,CAACM,IAAI,GAAG,IAAI,CAACM,EAAE,CAACN,IAAI,CAACY,KAAK;IACpC,IAAI,CAAClB,KAAK,CAACO,OAAO,GAAG,IAAI,CAACK,EAAE,CAACL,OAAO,CAACW,KAAK;IAE1C,IAAI,CAACpB,YAAY,CAACqB,MAAM,CAAC,IAAI,CAACnB,KAAK,CAAC,CAACoB,SAAS,CAAC;MAC7CC,IAAI,EAACA,CAAA,KAAK;QACR,IAAI,CAACtB,MAAM,CAACuB,aAAa,CAAC,UAAU,CAAC;MACvC,CAAC;MACDC,KAAK,EAAEC,aAAa,IAAI;QACtB,IAAI,CAAC3B,aAAa,CAAC0B,KAAK,CAACC,aAAa,CAACD,KAAK,EAAE,MAAM,CAAC;MACvD;KACD,CAAC;EACJ;;;mBAhDW/B,qBAAqB,EAAAiC,EAAA,CAAAC,iBAAA,CAAAC,EAAA,CAAAC,WAAA,GAAAH,EAAA,CAAAC,iBAAA,CAAAG,EAAA,CAAAC,WAAA,GAAAL,EAAA,CAAAC,iBAAA,CAAAK,EAAA,CAAAC,WAAA,GAAAP,EAAA,CAAAC,iBAAA,CAAAO,EAAA,CAAAC,aAAA,GAAAT,EAAA,CAAAC,iBAAA,CAAAS,EAAA,CAAAC,YAAA,GAAAX,EAAA,CAAAC,iBAAA,CAAAW,EAAA,CAAAC,MAAA;AAAA;;QAArB9C,qBAAqB;EAAA+C,SAAA;EAAAC,KAAA;EAAAC,IAAA;EAAAC,QAAA,WAAAC,+BAAAC,EAAA,EAAAC,GAAA;EAAAC,MAAA;AAAA;SAArBtD,qBAAqB"},"metadata":{},"sourceType":"module","externalDependencies":[]}